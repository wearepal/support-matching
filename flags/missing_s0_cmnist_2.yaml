# ===== dataset flags =====
a_dataset: "cmnist"
a_filter_labels: 2 4
a_padding: 2
a_missing_s: 0
#b_context_pcnt: 0.66666666
a_subsample_context:
    0: 0.5
    1: 0.5

# --- flags that are used in clusetering and fdm
a_background: False
a_batch_size: 128
a_biased_train: True
a_binarize: True
a_black: True
a_celeba_sens_attr: Male
a_celeba_target_attr: Smiling
a_color_correlation: 1
a_context_pcnt: 0.6667
a_data_pcnt: 1
a_data_split_seed: 888
a_drop_discrete: False
a_drop_native: True
a_early_stopping: 30
a_elbo_weight: 1
a_enc_out_dim: 16
a_encode_batch_size: 1000
a_eval_epochs: 40
a_eval_lr: 0.001
a_eval_on_recon: True
a_evaluate: False
a_recon_loss: l2
a_feat_attr: False
a_genfaces_sens_attr: "gender"
a_genfaces_target_attr: "emotion"
a_gpu: 0
a_greyscale: False
a_lr: 0.001
a_mixing_factor: 0
a_num_workers: 4
a_quant_level: 8
a_results_csv: ""
a_root: ""
a_rotate_data: False
a_save_dir: experiments/finn
a_scale: 0.02
a_seed: 42
a_shift_data: False
a_stochastic: False
a_test_pcnt: 0.2
a_use_wandb: True
a_val_freq: 5
a_vgg_weight: 0
a_weight_decay: 0
a_enc_init_chans: 32
a_input_noise: True
a_kl_weight: 1
a_vae_std_tform: exp
a_log_freq: 50

# ===== clustering flags =====
c_encoder: "ae"
c_enc_levels: 4
c_enc_epochs: 90
c_cl_hidden_dims:
c_epochs: 100
c_method: "pl_enc_no_norm"

# --- encoder flags ---
c_cluster: both
c_cluster_label_file: ""
c_enc_lr: 0.001
c_enc_path: ""
c_enc_wd: 0
c_finetune_encoder: False
c_finetune_lr: 0.000001
c_finetune_wd: 0
c_freeze_layers: 0
c_k_num: 5
c_labeler: "ranking"
c_lower_threshold: 0.5
#c_train_on_recon: False
c_upper_threshold: 0.5
#c_warmup_steps: 0
c_with_supervision: True

# --- clustering flags ---
#c_enc_path: /srv/galene0/pal/fair-dist-matching/experiments/finn/1590951542.6321526/encoder

# ===== disentangling flags =====
d_train_on_recon: True
d_levels: 4
d_vae: False
d_pred_s_weight: 2
# this makes zs channels be 1
d_zs_frac: 0.0469
d_num_disc_updates: 3
d_disc_hidden_dims: 256 256

# --- fdm args ---
d_ae_epochs: 5
#d_cluster_label_file: /srv/galene0/pal/fair-dist-matching/experiments/finn/1590954939.980953/cluster_results.pth
d_disc_lr: 0.001
d_disc_reset_prob: 0
d_distinguish_warmup: False
d_distinguish_weight: 1
d_epochs: 250
d_gamma: 1
d_inn_batch_norm: False
d_inn_bn_lag: 0
d_inn_coupling_channels: 256
d_inn_coupling_depth: 1
d_inn_glow: True
d_inn_idf: False
d_inn_level_depth: 1
d_inn_levels: 1
d_inn_lr: 0.0003
d_inn_oxbow_net: False
d_inn_reshape_method: "squeeze"
d_inn_scaling: "sigmoid0.5"
d_inn_spectral_norm: False
d_nll_weight: 0.01
d_num_discs: 1
d_path_to_ae: ""
d_pred_weight: 1
d_recon_detach: True
d_recon_stability_weight: 0
d_validate: True
d_val_freq: 20
d_use_inn: False
d_warmup_steps: 1000
