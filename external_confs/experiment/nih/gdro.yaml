# @package _global_

# usage: +experiment=nih/gdro

defaults:
    - override /ds: nih_gender_cardio
    - override /dm: nih/base
    - override /alg: gdro
    - override /labeller: none
    - override /split: nih/sb10
    - override /wandb: base
    - override /backbone: resnet
    - override /predictor: fcn
    - _self_

backbone:
    version: RN18

predictor:
    num_hidden: 2
    hidden_dim: null

dm:
    batch_size_tr: 12
    batch_size_te: 64
    num_samples_per_group_per_bag: 1

alg:
    alpha: 1.0
    normalize_loss: false
    gamma: 0.1
    step_size: 0.1
    btl: false
    adjustments: null

    lr: 1.e-4
    steps: 5000
    weight_decay: 0
    scheduler_cls: torch.optim.lr_scheduler.CosineAnnealingLR
    scheduler_kwargs:
    T_max: ${ eval.steps }
    eta_min: 5e-7

wandb:
    group: nih_gdro_sb10_cardio
