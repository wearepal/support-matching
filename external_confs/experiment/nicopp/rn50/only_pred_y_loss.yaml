# @package _global_

defaults:
    - /ae: cosine_annealing
    - /alg: supmatch_no_disc
    - /eval: nicopp
    - override /ae_arch: resnet/rn50_256_pre
    - override /dm: nicopp
    - override /ds: nicopp
    - override /labeller: gt
    - override /split: nicopp/change_is_hard
    - _self_

alg:
    pred_y_loss_w: 1.0
    enc_loss_w: 0.0
    steps: 30001
    use_amp: true
    pred:
        lr: 5.e-5
        scheduler_cls: ranzen.torch.schedulers.CosineLRWithLinearWarmup
        scheduler_kwargs:
            total_iters: ${ alg.steps }
            lr_min: 5.e-7
            warmup_iters: 0.05
    log_freq: 100000000000  # never
    val_freq: 1000

ae:
    lr: 5.e-5
    zs_dim: 1

dm:
    use_y_for_dep_bags: true
